<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <center><img src="images\Logo.jpg" width="350" height="350"/></center>
        <div class="menu">
            <h:form>
                <p:menubar>
                    <p:menuitem value="Catalog" icon="pi pi-home" outcome="index.xhtml"/>
                    <p:menuitem value="Edit Plants" icon="pi pi-pencil" outcome="edit_plants.xhtml"/>
                    <p:menuitem value="Shopping cart" icon="pi pi-shopping-cart" outcome="shopping_cart.xhtml"/>
                    <p:menuitem value="Orders" icon="pi pi-check" outcome="orders.xhtml"/>
                    <p:menuitem value="Profile" icon="pi pi-user" outcome="profile.xhtml"/>
                    <p:menuitem value="Log out" icon="pi pi-sign-out"/>
                </p:menubar>
            </h:form>
        </div>
    </h:head>
    <h:body>
        <h:form id="form">
            <div class="card crud-demo">
                <p:growl id="messages" showDetail="true"/>

                <p:toolbar>
                    <p:toolbarGroup>
                        <p:commandButton id="delete-products-button" value="#{shoppingCartBean.deleteButtonMessage}"
                                         icon="pi pi-trash" actionListener="#{shoppingCartBean.removeSelectedPlants()}"
                                         styleClass="ui-button-danger" disabled="#{!shoppingCartBean.hasSelectedPlants()}"
                                         update="@this">
                            <p:confirm header="Confirmation" message="Delete the selected products?"
                                       icon="pi pi-exclamation-triangle"/>
                        </p:commandButton>
                    </p:toolbarGroup>
                </p:toolbar>

                <p:dataTable id="dt-products" widgetVar="dtProducts" var="plant" value="#{shoppingCartBean.plants}"
                             reflow="true" styleClass="products-table" style="text-align:center"
                             selection="#{shoppingCartBean.selectedPlants}" rowKey="#{plant.plant.id}" paginator="true"
                             rows="10" rowSelectMode="add" paginatorPosition="bottom">
                    <f:facet name="header">
                        <div class="products-table-header">
                            <span style="font-weight: bold">PRODUCTS</span>

                            <span class="filter-container ui-input-icon-left">
                                <i class="pi pi-search"></i>
                                <p:inputText id="globalFilter" onkeyup="PF('dtProducts').filter()" placeholder="Search"/>
                            </span>

                        </div>
                    </f:facet>

                    <p:ajax event="rowSelect" update=":form:delete-products-button"/>
                    <p:ajax event="rowUnselect" update=":form:delete-products-button"/>
                    <p:ajax event="rowSelectCheckbox" update=":form:delete-products-button"/>
                    <p:ajax event="rowUnselectCheckbox" update=":form:delete-products-button"/>
                    <p:ajax event="toggleSelect" update=":form:delete-products-button"/>

                    <p:column selectionMode="multiple" exportable="false" width="30"></p:column>

                    <p:column headerText="Image" exportable="false">
                        <p:graphicImage value="images/#{plant.plant.picture}" library="demo"
                                        styleClass="product-image" width="180" height="180"/>
                    </p:column>
                    <p:column headerText="Details">
                        <h:outputText value="#{plant.plant.name}" style="font-weight: bold"/>
                        <div><p:rating value="#{plant.plant.rating}" readonly="true"/></div>
                        <div>
                            <h:outputLabel value="IN STOCK" rendered="#{plant.plant.numberOfItems > 0}" style="color:green;background-color:lightgreen;font-weight:bold"/> 
                            <h:outputLabel value="OUT OF STOCK" rendered="#{plant.plant.numberOfItems == 0}" style="color: red;background-color:peachpuff;font-weight:bold"/>
                        </div>
                        <div><h:outputText value="#{plant.plant.price} ILS" styleClass="product-price"/></div>
                        <div>
                            <p:panelGrid columns="2">
                                <h:outputText value="Light"/>
                                <h:outputText value="#{plant.plant.light}"/>

                                <h:outputText value="Water"/>
                                <h:outputText value="#{plant.plant.water}"/>

                                <h:outputText value="Fertilizer"/>
                                <h:outputText value="#{plant.plant.fertilize}"/>
                                            
                                <h:outputText value="Difficulty"/>
                                <h:outputText value="#{plant.plant.difficulty}"/>
                            </p:panelGrid>
                        </div>
                    </p:column>
                    <p:column exportable="false">
                        <p:commandButton class="ui-button-warning rounded-button" icon="pi pi-trash" process="@this"
                                         oncomplete="PF('deleteProductDialog').show()">
                            <f:setPropertyActionListener value="#{plant}" target="#{shoppingCartBean.selectedPlant}"/>
                        </p:commandButton>
                        <p:spinner id="minMax" value="#{plant.amount}" min="1" max="#{plant.plant.numberOfItems}"
                                   valueChangeListener="#{shoppingCartBean.saveAmount(plant)}"/>
                    </p:column>
                </p:dataTable>
                <p:confirmDialog widgetVar="deleteProductDialog" showEffect="fade" width="300"
                                 message="Delete the product?" header="Confirm" severity="warn">
                    <p:commandButton value="Yes" icon="pi pi-check" actionListener="#{shoppingCartBean.removeFromCart()}"
                                     process="@this" oncomplete="PF('deleteProductDialog').hide()"/>
                    <p:commandButton value="No" type="button" styleClass="ui-button-secondary" icon="pi pi-times"
                                     onclick="PF('deleteProductDialog').hide()" update="dt-Products"/>
                </p:confirmDialog>
            </div>
        </h:form>
    </h:body>
</html>